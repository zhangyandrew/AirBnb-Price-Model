---
title: "Airbnb Price Model"
author: "Andrew Zhang"
date: "12/6/2018"
output: pdf_document
---

# Abstract
The purpose of this project was to model 2016 Airbnb prices based on survey data such as room ID, host ID, neighborhood, and bedrooms and then test the model on different years of data to see if prices for those years are modeled the same. There were three regression models that were implemented to try to best fit this data: linear regression, log-linear regression, and a multilevel hierarchical model. We found that prices were often proportional to the housing rent of the area. Furthermore, prices seemed to be determined by the number of bedrooms being offered in the listing and how accommodating the listing was for visitors. After applying the 2016 models to both the 2014 and 2017 datasets, we were able to conclude that the way Airbnb priced in 2016 was potentially different from the way it priced listings in 2014. However, it seemed to price 2017 listings well, allowing us to conclude 2017 listings priced similarly to 2016 listings. 

# Background
Airbnb, although relatively new, has brought about a huge change in the field of hospitality. Rather than stay in hotels or motels, people now have the option to stay in the comfort of other people’s homes for a much cheaper rate. Airbnb allows it’s hosts to come up with prices for people who decide to stay in their homes, but Airbnb makes recommendations on prices as well. For this particular study, we want to look at a city that has a sizable number of listings. Therefore, we’ve selected Los Angeles, as it is a popular hotspot for tourism and hospitality. The goal of this project is to understand how Airbnb prices listings and whether or not we can create a model that can accurately predict different years of listings. Due to the abundance of data per room rental, we decided to create a model for each of the three room types to understand the characteristics of each rental type. We then applied the "best" models to the 2014 and 2017 AirBnb datasets to see how well the models predicted prices and compared those predictions to the actual prices of the listing. We suspect that the 2017 will be predicted better than 2014 as there is a lower likelihood that Airbnb would change their pricing criteria in such a short amount of time. 

```{r, include = FALSE}
setwd("/Users/andrewzhang/Desktop/School/Graduate/MA678/AirBnb-Price-Model")
airbnb2014 <- read.csv("tomslee_airbnb_los_angeles_0050_2014-09-01.csv")
airbnb2016 <- read.csv("tomslee_airbnb_los_angeles_0699_2016-12-17.csv")
airbnb2017 <- read.csv("tomslee_airbnb_los_angeles_1422_2017-07-08.csv")
rent <- read.csv("Rent_Price__LA_.csv")
```

```{r, include = FALSE}
install.packages("ggplot2", repos='http://cran.us.r-project.org')
install.packages("dplyr", repos='http://cran.us.r-project.org')
install.packages("knitr", repos='http://cran.us.r-project.org')
library(ggplot2)
library(dplyr)
library(knitr)

variable_names <- colnames(airbnb2016)
descriptions <- c('Identification of rooms given by Airbnb',
'Identification for hosts given by Airbnb',
'Type of room rental being listed(Shared Room, Private Room, Entire Home/Apartment)',
'A subregion of the city or search area for which the survey was carried out in',
'A subregion of the city or search area for which the survey was carried out in',
'Number of reviews given to a particular listing',
'Average rating(out of five) that a particular listing has received from past visitors',
'Number of guests the listing can house',
'Number of bedrooms the listing has',
'The amount of money required to stay per night',
'Minimum stay for a visit(by day)',
'Latitude of the listing posted on the Airbnb website', 
'Longitude of the listing posted on the Airbnb website',
'Date and time that the datapoints were read from the Airbnb website')
var_table <- data.frame(variable_names, descriptions)

str(airbnb2016)
colSums(is.na(airbnb2016))

airbnb2016$borough <- NULL
airbnb2016$last_modified <- NULL
airbnb2016$minstay <- NULL
airbnb2016 <- na.omit(airbnb2016)

rent$Year <- factor(rent$Year)
rent <- rent[rent$Year == "2016",]
rent <- na.omit(rent)

summary(airbnb2016)

neigh_count <- airbnb2016 %>% 
  group_by(neighborhood) %>% 
  count(neighborhood, sort = TRUE)

rent_agg <- rent %>% 
  group_by(Neighborhood) %>% 
  summarize(Average = mean(Amount))

airbnb2016 <- merge(airbnb2016, neigh_count)
colnames(airbnb2016)[1] <- c("Neighborhood")
colnames(airbnb2016)[12] <- c("Neighborhood Count")
airbnb2016 <- merge(airbnb2016, rent_agg, by = "Neighborhood")

airbnb2016_agg <- airbnb2016[airbnb2016$`Neighborhood Count` > 200,]

str(airbnb2017)
airbnb2017$room_id <- NULL
airbnb2017$survey_id <- NULL
airbnb2017$host_id <- NULL
airbnb2017$country <- NULL
airbnb2017$borough <- NULL
airbnb2017$bathrooms <- NULL
airbnb2017$minstay <- NULL
airbnb2017$last_modified <- NULL
airbnb2017$location <- NULL
airbnb2017$city <- NULL

str(airbnb2014)
airbnb2014$room_id <- NULL
airbnb2014$host_id <- NULL
airbnb2014$borough <- NULL
airbnb2014$minstay <- NULL
airbnb2014$last_modified <- NULL
airbnb2014 <- na.omit(airbnb2014)
```

## Variables
```{r, echo = FALSE}
kable(var_table, caption = "Variables")
```

```{r, correlation, include = FALSE}
install.packages("corrplot", repos='http://cran.us.r-project.org')
library(corrplot)

num_airbnb <- airbnb2016_agg[c(-1, -2, -3, -4)]

airbnb_cor <- cor(num_airbnb)
head(round(airbnb_cor, 3))
```

# Data Cleaning/Exploratory Data Analysis
Looking at the original dataset, we can see that it has 30671 observations with 13 variables. The first thing we look at is the structure of the data and the number of NA’s within each column. Immediately, we can remove the variables borough, minstay as the columns are filled with NA’s. Variables room_id, host_id, and last_modified are also removed because they don’t provide much for the analysis. Next, we look at neighborhood which is a factor with 202 levels. We only want to look at listings with a significant number of observations and ignore those with only a few listings. For this reason, we filter the dataset for neighborhoods containing more than 200 counts. Finally, we create three separate datasets by filtering for each of the room types(Entire Apartment, Private Room, Shared Room).

Next, we look at the importance of each variable.

```{r, echo = FALSE}
corrplot(airbnb_cor, method = "ellipse")
```

One of the first things we want to look at in terms of variables and their interactions is a correlation plot. We want to focus on the variable price as it is the response variable we are interested in. From the figure above, we can see that there is a strong correlation between price, accommodations, and bedrooms. We can also see a correlation between bedrooms and accommodations, however, this can be because the two are trivially related. 

```{r, include = FALSE}
neigh_count <- airbnb2016_agg %>% 
  group_by(Neighborhood) %>% 
  summarize(length = length(Neighborhood))

ggplot(data = airbnb2016_agg) +
  aes(x = log(price)) +
  geom_histogram(bins = 30, fill = '#0c4c8a') +
  theme_minimal() +
  facet_wrap(vars(room_type)) +
  labs(title = "Price Count")

ggplot(data = airbnb2016_agg) +
  aes(x = bedrooms) +
  geom_histogram(bins = 30, fill = '#0c4c8a') +
  theme_minimal() +
  labs(title = "Bedroom Counts")

ggplot(data = airbnb2016_agg) +
  aes(x = reviews, y = log(price)) +
  geom_point(color = '#0c4c8a', alpha = 0.5) +
  theme_minimal() +
  facet_wrap(vars(room_type)) +
  labs(title = "Reviews vs. Prices")
```

```{r, echo = FALSE}
ggplot(data = neigh_count) +
  aes(x = reorder(Neighborhood, length), 
      y = length, fill = '#0c4c8a') +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle=90, hjust=1), legend.position="none") + 
  coord_flip() +
  labs(title = "Neighborhood Count") +
  xlab("Neighborhood") +
  ylab("Count")
```

In the figure above, we can see that there are a couple of neighborhoods with significantly more counts than the others. Cities like Venice, Hollywood, Long Beach, Santa Monica are all some of the most popular cities in Los Angeles. Originally, there were 202 neighborhoods, but since we only wanted the top cities, we reduced the number of neighborhoods to 40 based on the counts. 

```{r, echo = FALSE}
ggplot(data = airbnb2016_agg) +
  aes(x = reviews, y = log(price), color = room_type) +
  geom_point(alpha = 0.5) +
  theme_minimal() +
  labs(title = "Reviews vs. Price")
```

The figure above shows a distribution of pricing in relation to the number of reviews left for each listing separated by room type. As we can see from the visual, a large majority of the data points are concentrated around 0, regardless of room type. This indicates that the majority of people do not leave reviews after their stays. However, we can also see that there is a segmentation of pricing amongst the groups, where apartments generally cost more than private rooms which generally cost more than shared rooms. In addition, apartments appear to have more reviews than private rooms or shared rooms. 

```{r, echo = FALSE}
ggplot(data = airbnb2016_agg) +
  aes(x = overall_satisfaction, y = log(price)) +
  geom_jitter(color = '#0c4c8a', alpha = 0.5) +
  theme_minimal() +
  facet_wrap(vars(room_type)) + 
  labs(title = "Satisfaction vs. Price")
```

Looking at the figure above, we can see that each of the types of rentals have a significant number of 0’s in overall satisfaction. These 0’s represent surveys that were left unanswered, however, prices tend to increase as the satisfaction increases in all types of rentals. We can also see that the prices generally decrease for each of the room types. 

```{r, echo = FALSE}
ggplot(data = airbnb2016_agg) +
  aes(x = accommodates, y = log(price), color = room_type) +
  geom_point() +
  theme_minimal() +
  facet_wrap(vars(room_type)) + 
  labs(title = "Accommodations vs. Price")
```

From the figure above, we can see that there is a positive trend between accommodation and price only in the home and apartment rentals. This makes sense as private rooms and shared rooms won’t be able to house as many people as an entire home or apartment. Therefore, we can see that accommodations for home and apartment range between 1 and 16, whereas accommodations for private and shared rooms are clustered between 1 and 6.

```{r, aggregate, include = FALSE}
install.packages("ggpubr", repos='http://cran.us.r-project.org')
library(ggpubr)

airbnb_agg1 <- airbnb2016_agg %>% 
  group_by(Neighborhood, room_type) %>% 
  summarize(Price_Ave = mean(price)) 

airbnb_agg2 <- airbnb2016_agg %>% 
  group_by(Neighborhood, room_type) %>% 
  summarize(Reviews = sum(reviews))

airbnb_agg3 <- airbnb2016_agg %>% 
  group_by(Neighborhood, room_type) %>% 
  summarize(Satisfaction_Ave = mean(overall_satisfaction)) 

airbnb_agg4 <- airbnb2016_agg %>% 
  group_by(Neighborhood, room_type) %>% 
  summarize(Accomm_Ave = mean(accommodates)) 

airbnb_agg5 <- airbnb2016_agg %>% 
  group_by(Neighborhood, room_type) %>% 
  summarize(Num_Bedrooms = mean(bedrooms))

airbnb_agg6 <- airbnb2016_agg %>% 
  group_by(Neighborhood, room_type) %>% 
  summarize(Neighborhood_Count = mean(`Neighborhood Count`))

airbnb_agg7 <- airbnb2016_agg %>% 
  group_by(Neighborhood, room_type) %>% 
  summarize(Rent_Average = mean(Average))

airbnb2016_aggdf <- merge(airbnb_agg1, airbnb_agg2)
airbnb2016_aggdf <- merge(airbnb2016_aggdf, airbnb_agg3)
airbnb2016_aggdf <- merge(airbnb2016_aggdf, airbnb_agg4)
airbnb2016_aggdf <- merge(airbnb2016_aggdf, airbnb_agg5)
airbnb2016_aggdf <- merge(airbnb2016_aggdf, airbnb_agg6)
airbnb2016_aggdf <- merge(airbnb2016_aggdf, airbnb_agg7)

## Create separate aggregated datasets for each room type
apart2016 <- airbnb2016_aggdf %>% 
  filter(airbnb2016_aggdf$room_type == "Entire home/apt")

private2016 <- airbnb2016_aggdf %>% 
  filter(airbnb2016_aggdf$room_type == "Private room")

shared2016 <- airbnb2016_aggdf %>% 
  filter(airbnb2016_aggdf$room_type == "Shared room")

## Aggregated data EDA
## Rent average vs. Airbnb prices
rent1 <- ggplot(data = apart2016) +
  aes(x = Rent_Average, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() + 
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Apartment Ave. Rent vs. Price")

rent2 <- ggplot(data = private2016) +
  aes(x = Rent_Average, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() + 
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Private Ave. Rent vs. Price")

rent3 <- ggplot(data = shared2016) +
  aes(x = Rent_Average, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() + 
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Shared Ave. Rent vs. Price")

## Reviews vs Airbnb prices
ggplot(data = apart2016) +
  aes(x = Reviews, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Apartment Reviews vs. Average Price")

ggplot(data = private2016) +
  aes(x = Reviews, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Private Room Reviews vs. Average Price")

ggplot(data = shared2016) +
  aes(x = Reviews, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Shared Room Reviews vs. Average Price")

## Accommodation average vs. Airbnb prices
accom1 <- ggplot(data = apart2016) +
  aes(x = Accomm_Ave, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Apartment Accommodation vs. Price")

accom2 <- ggplot(data = private2016) +
  aes(x = Accomm_Ave, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Private Accommodation vs. Price")

accom3 <- ggplot(data = shared2016) +
  aes(x = Accomm_Ave, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Shared Accommodation vs. Price")

## Neighborhood Count vs. Airbnb price
ggplot(data = apart2016) +
  aes(x = Neighborhood_Count, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Apartment Neighborhood Count vs. Average Price")

ggplot(data = private2016) +
  aes(x = Neighborhood_Count, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Private Neighborhood Count vs. Average Price")

ggplot(data = shared2016) +
  aes(x = Neighborhood_Count, y = log(Price_Ave), color = Neighborhood) +
  geom_point() +
  theme_minimal() +
  theme(legend.key.size=unit(2,"point"), legend.text = element_text(size = 12)) +
  labs(title = "Shared Neighborhood Count vs. Average Price")
```

```{r, echo = FALSE}
ggarrange(rent1, rent2, rent3, ncol=1, nrow = 3, common.legend = TRUE, legend="right")
```

One of the interactions we want to look at when referring to hospitality prices is the respective rent for specific areas. Therefore, given there are multiple observations for the same neighborhoods, we took the average of the prices listed within these neighborhoods and aggregated all the observations into one observation. Then we compared them to the respective average rent for the area. From the figure above, we can see that there is a positive trend between the rent and the price of the listing. The data is relatively homogeneous for all three rental types. Logically, this makes sense as the more luxurious the area, the more expensive a listing with be. 

```{r, echo = FALSE}
ggarrange(accom1, accom2, accom3, ncol=1, nrow = 3, common.legend = TRUE, legend="right")
```

Next, we want to look at is accommodations as it is closely related to pricing. In the figure above, we can see that for apartments, there is a clear positive trend between the number of accommodations and the prices for the listing. However, looking at the Private Rooms and Shared Rooms, the data is more heterogenous, making it more difficult to draw any relation between the prices and accommodations. These patterns are reflective of the trends featured in the accommodations vs. price figure described earlier in the report.  

```{r, split data, include = FALSE}
airbnb2016_agg$room_id <- NULL
airbnb2016_agg$host_id <- NULL
airbnb2016_agg$`Neighborhood Count` <- NULL
airbnb2016_agg$Average <- NULL

airbnb2014_agg <- airbnb2014[airbnb2014$neighborhood %in% airbnb2016_agg$Neighborhood,]
airbnb2017_agg <- airbnb2017[airbnb2017$neighborhood %in% airbnb2016_agg$Neighborhood,]

colnames(airbnb2014_agg)[2] <- "Neighborhood"
colnames(airbnb2017_agg)[2] <- "Neighborhood"

## 2016 Dataset
airbnb16_apart <- airbnb2016_agg[airbnb2016_agg$room_type == "Entire home/apt",]
airbnb16_apart$room_type <- NULL

airbnb16_private <- airbnb2016_agg[airbnb2016_agg$room_type == "Private room",]
airbnb16_private$room_type <- NULL

airbnb16_share <- airbnb2016_agg[airbnb2016_agg$room_type == "Shared room",]
airbnb16_share$room_type <- NULL

## 2017 Dataset
airbnb17_apart <- airbnb2017_agg[airbnb2017_agg$room_type == "Entire home/apt",]
airbnb17_apart$room_type <- NULL

airbnb17_private <- airbnb2017_agg[airbnb2017_agg$room_type == "Private room",]
airbnb17_private$room_type <- NULL

airbnb17_share <- airbnb2017_agg[airbnb2017_agg$room_type == "Shared room",]
airbnb17_share$room_type <- NULL

## 2014 Dataset
airbnb14_apart <- airbnb2014_agg[airbnb2014_agg$room_type == "Entire home/apt",]
airbnb14_apart$room_type <- NULL

airbnb14_private <- airbnb2014_agg[airbnb2014_agg$room_type == "Private room",]
airbnb14_private$room_type <- NULL

airbnb14_share <- airbnb2014_agg[airbnb2014_agg$room_type == "Shared room",]
airbnb14_share$room_type <- NULL
```

# Methods
This data was taken from Tom Slee on his website where he compiled and collected the data from Airbnb’s website. 

## Outlier Detection
Given that we run the model twice, we will see that the second set of models perform signficantly better than the first set in both R-squared values and AIC values. This can be attributed to the use of Cook's Distance to detect outliers. By determining the influential points in each dataset, we were able to remove them and create a model more representative of the general population of points.

## Linear Regression
We start off modeling applying a linear regression to see whether the data follows a linear normal distribution. To a certain degree it does, however, there were a number of things that were done to help improve model performance. 

## Log Linear Regression
If we look at the linear regression model, we can see there are extreme values being plotted. This is a combination of multiple variables, but if we look at the price variable, we can see that for certain neighborhoods, there are extreme values. In order to combat this, we apply a log transformation to the prices. We can see that the model performs significantly better in the model check section. 

## Log Linear Regression with Interaction
If we go back to the correlation plot, we can see that there is a strong correlation between bedrooms and accommodations. For that reason, it was worth looking into a potential interaction between the two using a model. 

## Multilevel Model
We ran a multilevel model because there were multiple observations for certain variables such as host_ID and neighborhoods. Therefore, we created linear models taking into account the nested factor levels in neighborhoods.

```{r, linear regression, include = FALSE}
apart_lm1 <- lm(price ~. , data = airbnb16_apart)
summary(apart_lm1)
plot(apart_lm1)

apart_lm2 <- lm(log(price) ~., data = airbnb16_apart)
summary(apart_lm2)
plot(apart_lm2)

apart_lm3 <- lm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_apart)
summary(apart_lm3)
plot(apart_lm3)

private_lm1 <- lm(price ~., data = airbnb16_private)
summary(private_lm1)
plot(private_lm1)

private_lm2 <- lm(log(price) ~., data = airbnb16_private)
summary(private_lm2)
plot(private_lm2)

private_lm3 <- lm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_private)
summary(private_lm3)
plot(private_lm3)

share_lm1 <- lm(price ~., data = airbnb16_share)
summary(share_lm1)
plot(share_lm1)

share_lm2 <- lm(log(price) ~., data = airbnb16_share)
summary(share_lm2)
plot(share_lm2)

share_lm3 <- lm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_share)
summary(share_lm3)
plot(share_lm3)
```

```{r, remove outliers, include = FALSE}
## Cooks Distance
cooksd_apart1 <- cooks.distance(apart_lm1)
cooksd_apart2 <- cooks.distance(apart_lm2)
cooksd_apart3 <- cooks.distance(apart_lm3)

cooksd_private1 <- cooks.distance(private_lm1)
cooksd_private2 <- cooks.distance(private_lm2)
cooksd_private3 <- cooks.distance(private_lm3)

cooksd_share1 <- cooks.distance(share_lm1)
cooksd_share2 <- cooks.distance(share_lm2)
cooksd_share3 <- cooks.distance(share_lm3)

## Influential Rows
influential1 <- as.numeric(names(cooksd_apart1))[cooksd_apart1 > (4/nrow(airbnb16_apart))]
influential2 <- as.numeric(names(cooksd_apart2))[cooksd_apart2 > (4/nrow(airbnb16_apart))]
influential3 <- as.numeric(names(cooksd_apart3))[cooksd_apart3 > (4/nrow(airbnb16_apart))]

influential4 <- as.numeric(names(cooksd_private1))[cooksd_private1 > (4/nrow(airbnb16_apart))]
influential5 <- as.numeric(names(cooksd_private2))[cooksd_private2 > (4/nrow(airbnb16_apart))]
influential6 <- as.numeric(names(cooksd_private3))[cooksd_private3 > (4/nrow(airbnb16_apart))]

influential7 <- as.numeric(names(cooksd_share1))[cooksd_share1 > (4/nrow(airbnb16_apart))]
influential8 <- as.numeric(names(cooksd_share2))[cooksd_share2 > (4/nrow(airbnb16_apart))]
influential9 <- as.numeric(names(cooksd_share3))[cooksd_share3 > (4/nrow(airbnb16_apart))]

## Cleaned df
airbnb16_apart1 <- airbnb16_apart[!as.numeric(rownames(airbnb16_apart)) %in% influential1,]
airbnb16_apart2 <- airbnb16_apart[!as.numeric(rownames(airbnb16_apart)) %in% influential2,]
airbnb16_apart3 <- airbnb16_apart[!as.numeric(rownames(airbnb16_apart)) %in% influential3,]

airbnb16_private1 <- airbnb16_private[!as.numeric(rownames(airbnb16_private)) %in% influential4,]
airbnb16_private2 <- airbnb16_private[!as.numeric(rownames(airbnb16_private)) %in% influential5,]
airbnb16_private3 <- airbnb16_private[!as.numeric(rownames(airbnb16_private)) %in% influential6,]

airbnb16_share1 <- airbnb16_share[!as.numeric(rownames(airbnb16_share)) %in% influential7,]
airbnb16_share2 <- airbnb16_share[!as.numeric(rownames(airbnb16_share)) %in% influential8,]
airbnb16_share3 <- airbnb16_share[!as.numeric(rownames(airbnb16_share)) %in% influential9,]
```

```{r, retest lm, include = FALSE}
apart_lm1 <- lm(price ~. , data = airbnb16_apart1)
apart_lm2 <- lm(log(price) ~., data = airbnb16_apart2)
apart_lm3 <- lm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_apart3)

plot(apart_lm1)
plot(apart_lm2)
plot(apart_lm3)

private_lm1 <- lm(price ~., data = airbnb16_private1)
private_lm2 <- lm(log(price) ~., data = airbnb16_private2)
private_lm3 <- lm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_private3)

plot(private_lm1)
plot(private_lm2)
plot(private_lm3)

share_lm1 <- lm(price ~., data = airbnb16_share1)
share_lm2 <- lm(log(price) ~., data = airbnb16_share2)
share_lm3 <- lm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_share3)

plot(share_lm1)
plot(share_lm2)
plot(share_lm3)

## glm for AIC
apart_glm1 <- glm(price ~. , data = airbnb16_apart1)
apart_glm2 <- glm(log(price) ~., data = airbnb16_apart2)
apart_glm3 <- glm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_apart3)

private_glm1 <- glm(price ~., data = airbnb16_private1)
private_glm2 <- glm(log(price) ~., data = airbnb16_private2)
private_glm3 <- glm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_private3)

share_glm1 <- glm(price ~., data = airbnb16_share1)
share_glm2 <- glm(log(price) ~., data = airbnb16_share2)
share_glm3 <- glm(log(price) ~ Neighborhood + reviews + overall_satisfaction + accommodates + bedrooms + latitude  + longitude + accommodates*bedrooms, data = airbnb16_share3)

summary(apart_lm1)
summary(apart_lm2)
summary(apart_lm3)
summary(private_lm1)
summary(private_lm2)
summary(private_lm3)
summary(share_lm1)
summary(share_lm2)
summary(share_lm3)

summary(apart_glm1)
summary(apart_glm2)
summary(apart_glm3)
summary(private_glm1)
summary(private_glm2)
summary(private_glm3)
summary(share_glm1)
summary(share_glm2)
summary(share_glm3)
```

# Results
Given that we ran three different linear regression models for three separate room type datasets, the models we select as the most optimal are:

- **Apartment/Home: Log Linear with Interaction** 
- **Private Room: Log Linear Model**
- **Shared Room: Log Linear with Interaction**

Table 2 is a chart of the R-squared values for the raw data.

```{r, include = FALSE}
type <- c("Apartment/Home", "Private", "Shared")
R2LM <- c(0.3039, 0.219, 0.1781)
R2LLM <- c(0.6017, 0.2215, 0.3069)
R2LLIM <- c(0.6033, 0.2218, 0.3069)
R2 <- data.frame(type, R2LM, R2LLM, R2LLIM)
colnames(R2) <- c(" ","Linear Model", "Log Linear Model", "Log Linear with Interaction")

type <- c("Apartment/Home", "Private", "Shared")
AICLM <- c(184545, 55840, 5223.9)
AICLLM <- c(11078, 1081.3, -288.55)
AICLLIM <- c(11027, 1130.3, -288.55)
AIC <- data.frame(type, AICLM, AICLLM, AICLLIM)
colnames(AIC) <- c(" ","Linear Model", "Log Linear Model", "Log Linear with Interaction")

type <- c("Apartment/Home", "Private", "Shared")
R2LM2 <- c(0.5326, 0.292, 0.562)
R2LLM2 <- c(0.67, 0.3211, 0.3198)
R2LLIM2 <- c(0.562, 0.8058, 0.8058)
R2_2 <- data.frame(type, R2LM2, R2LLM2, R2LLIM2)
colnames(R2_2) <- c(" ","Linear Model", "Log Linear Model", "Log Linear with Interaction")
```

```{r, echo = FALSE}
kable(R2, caption = "Raw Data R-Squared Values")
```

However, as we will see in the model checking, there are significant outliers in the data. By removing those and plotting the results, we can see that our models improve significantly. Table 3 is the chart of R-squared values for the cleaned data.

```{r, echo = FALSE}
kable(R2, caption = "No Outlier R-Squared Values")
```

We can still see that the log-linear regression with interactions suits the data from private and shared rooms the best, but the log-linear model fits the data collected from apartments better. Next we look at the AIC values for both the linear regression models and the multilevel hierarchical model nested by neighborhoods. AIC will help us compare all of the models as multilevel models do not have R-squared values.

*Linear Regression*

```{r, echo = FALSE}
kable(AIC, caption = "Linear Regression AIC")
```

Next we look at the multilevel AIC values

*Multilevel*

```{r, include = FALSE}
type <- c("Apartment/Home", "Private", "Shared")
AICLM2 <- c(184674, 55964, 5279.1)
AICLLM2 <- c(11277.1, 1251.1, -175)
AICLLIM2 <- c(11239.8, 1301.1, -175)
AIC_2 <- data.frame(type, AICLM, AICLLM, AICLLIM)
colnames(AIC_2) <- c(" ","Linear Model", "Log Linear Model", "Log Linear with Interaction")
```

```{r, echo = FALSE}
kable(AIC_2, caption = "Mutlilevel AIC")
```

Now that we have compared all of the models, we can see that the linear regression models perform better than the multilevel models just slightly. Using the AIC and R-squared values, we can conclude that the log-linear model is best for the private room listings and the log-linear with interaction is best for apartment and shared room listings. 

## Interpretation

*Apartment/Home*

* Intercept: The average price for an apartment, when all other variables are 0, is exp(-75.21) or 2.17 x 10^-33^ 
* Reviews: For every one unit increase in reviews, while all other variables are held constant, the price of the listing increases by exp(-0.0005079) or 0.99949
* Overall_Satisfaction: For every one unit increase in overall satisfaction, while all other variables are held constant, the price of the listing increases by exp(-0.009568) or 0.9905
* Accommodates: For every one unit increase in accommodations, while all other variables are held constant, the price of the listing increases by exp(0.05305) or 1.0545
* Bedrooms: For every one unit increase in bedrooms, while all other variables are held constant, the price of the listing increases by exp(0.2876) or 1.333
* Latitude: For every one unit increase in latitude, while all other variables are held constant, the price of the listing increases by exp(-1.875) or 0.15333
* Longitude: For every one unit increase in longitude, while all other variables are held constant, the price of the listing increases by exp(-1.216) or 0.2964
* Accommodates:Bedrooms: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(0.001711) or 1.002
* Neighborhoods: The differences in pricing amongst the various neighborhoods ranges from -56.3% to 4.133%

*Private*

* Intercept: The average price for an apartment, when all other variables are 0, is exp(-116.5) or 2.53 x 10^-51^
* Reviews: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(-0.0001529) or 1.000
* Overall_Satisfaction: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(0.02316) or 0.9771
* Accommodates: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(0.08402) or 1.0877
* Bedrooms: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(-0.3198) or 0.7263
* Latitude: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(-1.073) or 0.3419
* Longitude: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(-1.333) or 0.26369
* Neighborhoods: The differences in pricing amongst the various neighborhoods ranges from -52.7% to 9.39%

*Shared*

* Intercept: The average price for an apartment, when all other variables are 0, is exp(147.4) 
* Reviews: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(-0.0002226) or 0.99978
* Overall_Satisfaction: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(0.02545) or 1.026
* Accommodates: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(0.0182) or 1.01836
* Bedrooms: NA since the number of bedrooms is only 1
* Latitude: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(-3.094) or 0.04532
* Longitude: For every one unit increase in, while all other variables are held constant, the price of the listing increases by exp(1.3844) or 0.3253
* Neighborhoods: The differences in pricing amongst the various neighborhoods ranges from -4.7% to 147.2%

## Model Checking
We look at 4 models for each of the 3 different room types: apartment, private room, and shared room. Please refer to the *Appendix* for the models.

First, we will take a look at the residuals vs. fitted plots. From the figures, we can see that the linear models had several outliers that deviated away from the center of 0. However, applying log helped to center most of the data points closer to 0. We can see that there are still a couple of small outliers in both the log-linear and log-linear with interaction residual plots. For the most part, these two plots are identical. Then considering the multilevel model, we can see, that similar to the diagnostics for the log-linear models, there are a couple of points slightly further away from the 0 line. 

Despite these few outliers in these "cleaned" datasets, looking at the Normal Q-Q plots, we can see that the data emulates something close to a normal distribution. Before we cleaned and removed these outliers using Cook's Distance, we could see a stronger tail at each end of the Normal QQ plots. 

```{r, multilevel, include = FALSE}
install.packages("lme4", repos='http://cran.us.r-project.org')
install.packages("arm", , repos='http://cran.us.r-project.org')
library(lme4)
library(arm)

## Apartment
apart_ml1 <- lmer(price ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + (1|Neighborhood), data = airbnb16_apart1)
display(apart_ml1)
plot(apart_ml1, main = "Apartment LM Mulilevel Residual vs. Fitted")

apart_ml2 <- lmer(log(price) ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + (1|Neighborhood), data = airbnb16_apart2)
display(apart_ml2)
plot(apart_ml2, main = "Apartment Log Linear Mulilevel Residual vs. Fitted")

apart_ml3 <- lmer(log(price) ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + accommodates*bedrooms + (1|Neighborhood), data = airbnb16_apart3)
display(apart_ml3)
plot(apart_ml3, main = "Apartment Log Linear Interaction Mulilevel Residual vs. Fitted")

## Private
private_ml1 <- lmer(price ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + (1|Neighborhood), data = airbnb16_private1)
display(private_ml1)
plot(private_ml1, main = "Private LM Multilevel Residual vs. Fitted")

private_ml2 <- lmer(log(price) ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + (1|Neighborhood), data = airbnb16_private2)
display(private_ml2)
plot(private_ml2, main = "Private Log Linear Multilevel Residual vs. Fitted")

private_ml3 <- lmer(log(price) ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + accommodates*bedrooms + (1|Neighborhood), data = airbnb16_private3)
display(private_ml3)
plot(private_ml3, main = "Private Log Linear Interaction Multilevel Residual vs. Fitted")

## Shared
share_ml1 <- lmer(price ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + (1|Neighborhood), data = airbnb16_share1)
display(share_ml1)
plot(share_ml1, main = "Shared LM Multilevel Residual vs. Fitted")

share_ml2 <- lmer(log(price) ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + (1|Neighborhood), data = airbnb16_share2)
display(share_ml2)
plot(share_ml2, main = "Shared Log Linear Multilevel Residual vs. Fitted")

share_ml3 <- lmer(log(price) ~ reviews + overall_satisfaction + accommodates + bedrooms + latitude + longitude + accommodates*bedrooms + (1|Neighborhood), data = airbnb16_share3)
display(share_ml3)
plot(share_ml3, main = "Shared Log Linear Interaction Multilevel Residual vs. Fitted")

display(apart_ml1)
display(apart_ml2)
display(apart_ml3)

display(private_ml1)
display(private_ml2)
display(private_ml3)

display(share_ml1)
display(share_ml2)
display(share_ml3)
```

```{r, include = FALSE}
## Gather specific neighborhoods for 2014
airbnb14_apart <- airbnb14_apart[airbnb14_apart$Neighborhood %in% airbnb16_apart3$Neighborhood,]
airbnb14_private <- airbnb14_private[airbnb14_private$Neighborhood %in% airbnb16_private2$Neighborhood,]
airbnb14_share <- airbnb14_share[airbnb14_share$Neighborhood %in% airbnb16_share3$Neighborhood,]

## Gather specific neighborhoods for 2014
airbnb17_apart <- airbnb17_apart[airbnb17_apart$Neighborhood %in% airbnb16_apart3$Neighborhood,]
airbnb17_private <- airbnb17_private[airbnb17_private$Neighborhood %in% airbnb16_private2$Neighborhood,]
airbnb17_share <- airbnb17_share[airbnb17_share$Neighborhood %in% airbnb16_share3$Neighborhood,]
```

```{r, predictions 2014/2017, include = FALSE, warning=FALSE}
install.packages("reshape2", repos='http://cran.us.r-project.org')
library(reshape2)
## Linear Regression
## Create predictions for 2014 data(validation)
apart14_pred <- data.frame(predict(apart_lm2, airbnb14_apart, interval = "prediction"))
private14_pred <- data.frame(predict(private_lm2, airbnb14_private, interval = "prediction"))
share14_pred <- data.frame(predict(share_lm2, airbnb14_share, interval = "prediction"))

## Create predictions for 2017 data(validation)
apart17_pred <- data.frame(predict(apart_lm3, airbnb17_apart, interval = "prediction"))
private17_pred <- data.frame(predict(private_lm2, airbnb17_private, interval = "prediction"))
share17_pred <- data.frame(predict(share_lm3, airbnb17_share, interval = "prediction"))

## Multilevel Predictions
## Create predictions for 2014 data(validation)
apart14_predml <- data.frame(predict(apart_ml1, airbnb14_apart, interval = "prediction"))
private14_predml <- data.frame(predict(private_ml2, airbnb14_private, interval = "prediction"))
share14_predml <- data.frame(predict(share_ml3, airbnb14_share, interval = "prediction"))

## Create predictions for 2017 data(validation)
apart17_predml <- data.frame(predict(apart_ml3, airbnb17_apart, interval = "prediction"))
private17_predml <- data.frame(predict(private_ml2, airbnb17_private, interval = "prediction"))
share17_predml <- data.frame(predict(share_ml3, airbnb17_share, interval = "prediction"))

## 2014 Comparison Between All Models
## Apartment
apartpred_14 <- data.frame(log(airbnb14_apart$price))
apartpred_14$LM <- cbind(apart14_pred$fit)
apartpred_14$ML <- cbind(apart14_predml$predict.apart_ml..airbnb14_apart..interval....prediction..)
apartpred_14$Type <- "Apart"
colnames(apartpred_14)[1] <- "Price"

## Private Room
privatepred_14 <- data.frame(log(airbnb14_private$price))
privatepred_14$LM <- cbind(private14_pred$fit)
privatepred_14$ML <- cbind(private14_predml$predict.private_ml..airbnb14_private..interval....prediction..)
privatepred_14$Type <- "Private"
colnames(privatepred_14)[1] <- "Price"

## Shared Room
sharedpred_14 <- data.frame(log(airbnb14_share$price))
sharedpred_14$LM <- cbind(share14_pred$fit)
sharedpred_14$ML <- cbind(share14_predml$predict.share_ml..airbnb14_share..interval....prediction..)
sharedpred_14$Type <- "Shared"
colnames(sharedpred_14)[1] <- "Price"

## 2017 Comaprison Between All Models
## Apartment
apartpred_17 <- data.frame(log(airbnb17_apart$price))
apartpred_17$LM <- cbind(apart17_pred$fit)
apartpred_17$ML <- cbind(apart17_predml$predict.apart_ml..airbnb17_apart..interval....prediction..)
apartpred_17$Type <- "Apart"
colnames(apartpred_17)[1] <- "Price"

## Private Room
privatepred_17 <- data.frame(log(airbnb17_private$price))
privatepred_17$LM <- cbind(private17_pred$fit)
privatepred_17$ML <- cbind(private17_predml$predict.private_ml..airbnb17_private..interval....prediction..)
privatepred_17$Type <- "Private"
colnames(privatepred_17)[1] <- "Price"

## Shared Room
sharedpred_17 <- data.frame(log(airbnb17_share$price))
sharedpred_17$LM <- cbind(share17_pred$fit)
sharedpred_17$ML <- cbind(share17_predml$predict.share_ml..airbnb17_share..interval....prediction..)
sharedpred_17$Type <- "Shared"
colnames(sharedpred_17)[1] <- "Price"

## Add indicies for all data
apartpred_14$Ind <- seq(1:nrow(apartpred_14))
privatepred_14$Ind <- seq(1:nrow(privatepred_14))
sharedpred_14$Ind <- seq(1:nrow(sharedpred_14))

apartpred_17$Ind <- seq(1:nrow(apartpred_17))
privatepred_17$Ind <- seq(1:nrow(privatepred_17))
sharedpred_17$Ind <- seq(1:nrow(sharedpred_17))

## Melt data for easier visualization
## 2014
apartpred14_melt <- melt(apartpred_14, c("Type", "Ind"))
privatepred14_melt <- melt(privatepred_14, c("Type", "Ind"))
sharedpred14_melt <- melt(sharedpred_14, c("Type", "Ind"))

## 2017
apartpred17_melt <- reshape2::melt(apartpred_17, c("Type", "Ind"))
privatepred17_melt <- reshape2::melt(privatepred_17, c("Type", "Ind"))
sharedpred17_melt <- reshape2::melt(sharedpred_17, c("Type", "Ind"))
```

# Discussion

```{r, include = FALSE}
## Visualize predictions vs actual data
## 2014 Prediction Comparisons
pred14_1 <- ggplot(apartpred14_melt) + 
  geom_line(aes(Ind, value, color = variable)) +
  theme_minimal() + 
  labs(title = "2014 Apartment")

pred14_2 <- ggplot(privatepred14_melt) + 
  geom_line(aes(Ind, value, color = variable)) +
  theme_minimal() + 
  labs(title = "2014 Private Room")

pred14_3 <- ggplot(sharedpred14_melt) + 
  geom_line(aes(Ind, value, color = variable)) +
  theme_minimal() + 
  labs(title = "2014 Shared Room")

## 2017 Prediction Comparisons
pred17_1 <- ggplot(apartpred17_melt) + 
  geom_line(aes(Ind, value, color = variable)) +
  theme_minimal() + 
  labs(title = "2017 Apartment")

pred17_2 <- ggplot(privatepred17_melt) + 
  geom_line(aes(Ind, value, color = variable)) +
  theme_minimal() + 
  labs(title = "2017 Private Room")

pred17_3 <- ggplot(sharedpred17_melt) + 
  geom_line(aes(Ind, value, color = variable)) +
  theme_minimal() + 
  labs(title = "2017 Shared Room")
```

## Implication

```{r, echo = FALSE}
figure <- ggarrange(pred14_1, pred14_2, pred14_3, pred17_1, pred17_2, pred17_3, ncol=3, nrow = 2, common.legend = TRUE, legend="right")
annotate_figure(figure, top = text_grob("Prediction vs. Actual"))
```

Given that Airbnb is at the forefront of hospitality in 2018, it is important to understand what factors play a role in influencing listing prices. Although there are other variables that can be taken into consideration, we already discovered that the most important variables are number of bedrooms and accommodations while also taking into consideration rental prices of the area. In addition, it seems as though the log-linear with interaction is the best model for the apartment/homes rental and shared rooms rental types, while the log linear model was better suited for the private rooms. Although we included an interaction term, there are very slight differences between the log-linear and the interaction models. For the most part, they both yield the same results. 

If we look at figure above, we plot the logarithmic price predictions for the 2014 and 2017 datasets in blue and compare them with the log of the actual prices given in the 2017 datasets, which are given in red. Looking at the plots, we can see a difference between the plots for 2014 and 2017. On one hand, the predictions for 2017 are much more in line with the actual predictions. There are clear outliers, however, the predictions seem to fit the data well as we don't see a red color on the surface of the blue. On the other hand, if we look at the 2014 predictions, we can see that the model doesn't fit as well, as the majority of the blue predictions sit below the actual listing prices in 2014. This could be an indication that the way AirBnb priced 2016 listings is still the same in 2017, whereas it had a different pricing criteria in 2016 than in 2014. Logically, 2017 is closer to 2016, so the way listings are priced should be similar, where, compared to 2014, there is more probability that Airbnb could propose new dimensions as to how they want to set listing prices.

## Limitation/Future Work
Even though we have 30000+ listings for Los Angeles, many of the columns such as reviews were filled with 0, making it difficult to accumulate a large enough sample size to make predictions from. With that being said, for future use, maybe we can either collect more data or employ more variables for the model. In terms of variables, the data was rather simple and we weren’t able to dive deeper into interactions and interactions nested within variables such as host_ID or room_ID. 

Another aspect that deserves to be looked at is the longitude and latitude. There are multiple observations per neighborhood but the longitude and latitudes within the neighborhoods are not the same. When looking up rent for these specific areas, it was very difficult to match the latitudes and longitudes to get specific rent prices for these subareas. Therefore, in the future, maybe we can convert these longitudes and latitudes into zip codes, making it significantly easier to match and find rent prices for specific areas. 

Finally for the multilevel model, one aspect that was potentially interesting was the nesting of rooms or hosts within the data. Given there are duplicate observations per host, we could theoretically create a model accounting for that. Unfortunately, there are too many unique hosts to create a model. In addition, the room_ID’s are all unique, meaning that the same room rented out by a host in one instance will have a different room ID if its rented out in another instance. Therefore, we cannot track rooms and nest the model accounting for the rooms. However, in the future, if more data was collected and the formatting of these host IDs and room IDs were changed, we could create multiple multilevel models accounting for host ID, room ID, and neighborhood.

# Acknowledgement
Thank you to Professor Yajima for supplying the tutorials and necessary understanding to complete this project. I would also like to thank Mr. Slee for providing the dataset for all Los Angeles listings.

# References
[1] http://tomslee.net/airbnb-data-collection-get-the-data

[2] Professor Yajima’s RStudio Tutorials

# Appendix
Model Check Figures:

## Residual vs. Fitted Plot

*Apartment/Home*

```{r, echo = FALSE}
plot(apart_lm1, which = 1, caption = "Apartment LM Residual vs. Fitted")

plot(apart_lm2, which = 1, caption = "Apartment Log-Linear Residual vs. Fitted")

plot(apart_lm3, which = 1, caption = "Apartment Log-Linear with Interaction Residual vs. Fitted")
```

*Private Room*

```{r, echo = FALSE}
plot(private_lm1, which = 1, caption = "Private Room LM Residual vs. Fitted")

plot(private_lm2, which = 1, caption = "Private Room Log-Linear Residual vs. Fitted")

plot(private_lm3, which = 1, caption = "Private Room Log-Linear with Interaction Residual vs. Fitted")
```

*Shared Room*

```{r, echo = FALSE}
plot(share_lm1, which = 1, caption = "Shared Room LM Residual vs. Fitted")

plot(share_lm2, which = 1, caption = "Shared Room Log-Linear Residual vs. Fitted")

plot(share_lm3, which = 1, caption = "Shared Room Log-Linear with Interaction Residual vs. Fitted")
```

### Multilevel Model

*Apartment/Home*

```{r, echo = FALSE}
plot(apart_ml2, main = "Apartment Log Linear Mulilevel Residual vs. Fitted")

plot(private_ml2, main = "Private Log Linear Multilevel Residual vs. Fitted")

plot(share_ml3, main = "Shared Log Linear Interaction Multilevel Residual vs. Fitted")
```

## Normal QQ-Plot

*Apartment/Home*

```{r, echo = FALSE}
plot(apart_lm1, which = 2, caption = NA, main = "Apartment LM Normal QQ")

plot(apart_lm2, which = 2, caption = NA, main = "Apartment Log-Linear Normal QQ")

plot(apart_lm3, which = 2, caption = NA, main = "Apartment Log-Linear with Interaction Normal QQ")
```

*Private Room*

```{r, echo = FALSE, warning=FALSE}
plot(private_lm1, which = 2, caption = NA, main = "Private Room LM Normal QQ")

plot(private_lm2, which = 2, caption = NA, main = "Private Room Log-Linear Normal QQ")

plot(private_lm3, which = 2, caption = NA, main = "Private Room Log-Linear with Interaction Normal QQ")
```

*Shared Room*

```{r, echo = FALSE, warning=FALSE}
plot(share_lm1, which = 2, caption = NA, main = "Shared Room LM Normal QQ")

plot(share_lm2, which = 2, caption = NA, main = "Shared Room Log-Linear Normal QQ")

plot(share_lm3, which = 2, caption = NA, main = "Shared Room Log-Linear with Interaction Normal QQ")
```

